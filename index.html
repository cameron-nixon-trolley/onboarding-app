<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Trolley Onboarding Planner — v10.1</title>
<style>
  :root { --bg:#f6f7fb; --card:#fff; --ink:#0f172a; --muted:#64748b; --accent:#2563eb; --border:#e2e8f0; }
  *{box-sizing:border-box}
  body{margin:0;padding:20px;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--ink)}
  header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:16px}
  h1{margin:0;font-size:18px;font-weight:700}
  .actions{display:flex;gap:8px;flex-wrap:wrap}
  button,select,input[type="text"],input[type="number"]{font:inherit;padding:8px 12px;border:1px solid var(--border);border-radius:10px;background:#fff}
  button{cursor:pointer}
  button.primary{background:var(--accent);color:#fff;border-color:var(--accent)}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
  .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px}
  .card h2{margin:0 0 10px;font-size:16px}
  .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-bottom:8px}
  label{font-size:13px;color:var(--muted)}
  .pill{display:inline-block;padding:4px 8px;border:1px solid var(--border);border-radius:999px;font-size:12px;margin-right:6px}
  .checklist{display:grid;grid-template-columns:1fr 1fr;gap:6px 24px}
  table{width:100%;border-collapse:collapse}
  th,td{padding:8px 10px;border-bottom:1px solid var(--border);text-align:left;vertical-align:top}
  th{background:#f8fafc}
  .diagram-wrap{width:100%;padding:10px;border:1px dashed var(--border);border-radius:8px;background:#f8fafc}
  .diagram-title{font-size:13px;color:var(--muted);margin-bottom:6px}
  .diagram{display:block;max-width:720px;width:100%;height:auto;margin:0 auto;border:1px solid var(--border);border-radius:8px}
  .placeholder{font-size:13px;color:var(--muted)}
  /* Step 2 grouping styles */
  .group-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}
  fieldset.group{border:1px solid var(--border);border-radius:10px;padding:10px;background:#fbfcfe}
  fieldset.group legend{font-weight:600;font-size:12px;color:var(--muted);padding:0 6px}
  .group .opt{display:block;margin:6px 0;font-size:14px}
  .hint{font-size:12px;color:var(--muted)}
  .muted{color:var(--muted);font-size:12px}
  @media print{
    header .actions{display:none}
    body{background:#fff}
    .card{break-inside:avoid}
    @page{size:A4;margin:16mm}
  }
</style>
</head>
<body>
  <header>
    <h1>Trolley Onboarding Planner — <span class="muted">v10.1</span></h1>
    <div class="actions">
      <button class="primary" id="btnPdf">Download as PDF</button>
      <button onclick="window.print()">Print</button>
      <button id="btnReset">Reset</button>
    </div>
  </header>

  <div class="grid">
    <!-- STEP 1 (kept minimal; no descriptive blurb) -->
    <section class="card" id="currentState">
      <h2>Step 1 · Merchant Overview</h2>
      <div class="row">
        <label>Merchant Name</label><input id="merchant_name" type="text" placeholder="Acme Co." />
        <label>Merchant Type</label>
        <select id="merchant_type">
          <option value=""></option>
          <option>Marketplace</option><option>Creator Platform</option><option>Gig Economy</option>
          <option>E-commerce</option><option>SaaS</option><option>Fintech</option><option>Other</option>
        </select>
      </div>
      <div class="row">
        <label>Merchant Onboarding Country</label>
        <select id="onboarding_country">
          <option value=""></option>
          <option>United States</option><option>Canada</option><option>United Kingdom</option>
          <option>Australia</option><option>European Union</option>
        </select>
        <label>Funding Currency</label>
        <select id="funding_currency">
          <option value=""></option>
          <option>USD</option><option>CAD</option><option>EUR</option><option>GBP</option><option>AUD</option>
        </select>
      </div>
      <div class="row">
        <div>
          <label>Recipient Countries (select all that apply)</label>
          <div class="row">
            <label class="pill"><input type="checkbox" class="rc" value="Canada" /> Canada</label>
            <label class="pill"><input type="checkbox" class="rc" value="USA" /> USA</label>
            <label class="pill"><input type="checkbox" class="rc" value="Europe" /> Europe</label>
            <label class="pill"><input type="checkbox" class="rc" value="LATAM" /> LATAM</label>
            <label class="pill"><input type="checkbox" class="rc" value="Asia" /> Asia</label>
            <label class="pill"><input type="checkbox" class="rc" value="Australia" /> Australia</label>
          </div>
        </div>
      </div>
    </section>

    <!-- STEP 2 (baseline checklist layout) -->
    <section class="card" id="workflows">
      <h2>Step 2 · Current Workflows</h2>
      <div class="hint">Select all that apply. <b>Payment Approvals</b> is a pick‑one group.</div>
      <div class="group-grid">
        <fieldset class="group">
          <legend>Onboarding</legend>
          <label class="opt"><input type="checkbox" id="onb_forms" /> Onboarding: Manual Forms</label>
          <label class="opt"><input type="checkbox" id="onb_spreadsheets" /> Onboarding: Spreadsheet Uploads</label>
          <label class="opt"><input type="checkbox" id="onb_api" /> Onboarding: API</label>
          <label class="opt"><input type="checkbox" id="onb_widget" /> Onboarding: Widget/Application</label>
        </fieldset>
        <fieldset class="group">
          <legend>Verification</legend>
          <label class="opt"><input type="checkbox" id="ver_manual" /> Verification: Manual</label>
          <label class="opt"><input type="checkbox" id="ver_3p_int" /> Verification: 3rd party (integrated)</label>
          <label class="opt"><input type="checkbox" id="ver_3p_nonint" /> Verification: 3rd party (non‑integrated)</label>
        </fieldset>
        <fieldset class="group">
          <legend>Payments</legend>
          <label class="opt"><input type="checkbox" id="pay_manual_psp" /> Payments: Manual payouts (E-Transfer, Wise, etc.)</label>
          <label class="opt"><input type="checkbox" id="pay_wires" /> Payments: Manual Wires</label>
          <label class="opt"><input type="checkbox" id="pay_cheques" /> Payments: Cheques</label>
          <label class="opt"><input type="checkbox" id="pay_digital_wallets" /> Payments: Digital Wallets (PayPal)</label>
        </fieldset>
        <fieldset class="group">
          <legend>Payment Approvals</legend>
          <label class="opt"><input type="checkbox" id="appr_none" /> Payment Approvals: None</label>
          <label class="opt"><input type="checkbox" id="appr_single" /> Payment Approvals: Single</label>
          <label class="opt"><input type="checkbox" id="appr_dual" /> Payment Approvals: Dual</label>
        </fieldset>
        <fieldset class="group">
          <legend>Tax</legend>
          <label class="opt"><input type="checkbox" id="tax_collects" /> Tax: Collects W‑8/W‑9</label>
          <label class="opt"><input type="checkbox" id="tax_manual_share" /> Tax: Manual sharing of forms</label>
          <label class="opt"><input type="checkbox" id="tax_eoy" /> Tax: End‑of‑Year Filing</label>
        </fieldset>
      </div>
    </section>

    <!-- PROPOSED SOLUTION -->
    <section class="card" id="solution">
      <h2>Proposed Solution</h2>
      <div class="row">
        <label>Recommended Bundle</label><div id="bundle" class="pill">—</div>
        <label>Integration Mode</label><div id="integration" class="pill">—</div>
        <label>Indicative Timeline</label><div id="timeline" class="pill">—</div>
      </div>
      <div class="row" style="width:100%;">
        <div class="diagram-wrap" style="width:100%;">
          <div class="diagram-title">Workflow Diagram</div>
          <div id="diagramPlaceholderB" class="placeholder">No diagram yet — check one or more boxes in <b>Step 2</b>.</div>
          <img id="diagramB" class="diagram" alt="Workflow diagram" style="display:none;" />
        </div>
      </div>
      <div class="row" style="flex-direction:column; align-items:flex-start;">
        <label>Narrative Summary</label>
        <div id="summary" style="padding:10px; border:1px solid var(--border); border-radius:8px; width:100%; background:#f8fafc;"></div>
      </div>
    </section>

    <!-- MAPPING -->
    <section class="card" id="mapping">
      <h2>Current → Future Mapping</h2>
      <table>
        <thead><tr><th>Process Step</th><th>Current Approach</th><th>Future with Trolley</th><th>Product(s)</th></tr></thead>
        <tbody id="mapBody"></tbody>
      </table>
    </section>

    <!-- ROADMAP -->
    <section class="card" id="roadmap">
      <h2>Implementation Roadmap</h2>
      <ol id="phases"></ol>
    </section>
  </div>

<script>
/* --- Static image paths (relative to this HTML file) --- */
const IMG = {
  PAY: "./assets/Pay.png",
  PAY_TAX: "./assets/Pay + Tax.png",
  PAY_TRUST: "./assets/Pay + Trust.png",
  PAY_TAX_TRUST: "./assets/Pay + Tax + Trust.png",
  // PayPal-only variants
  PAY_PAYPAL: "./assets/Pay (PayPal).png",
  PAY_TAX_PAYPAL: "./assets/Pay + Tax (PayPal).png",
  PAY_TRUST_PAYPAL: "./assets/Pay + Trust (PayPal).png",
  PAY_TAX_TRUST_PAYPAL: "./assets/Pay + Tax + Trust (PayPal).png"
};

/* ---- Helpers & core logic ---- */
const $ = (s)=>document.querySelector(s);

// all Step 2 checkbox IDs (must include every box)
const STEP2_IDS = [
  'onb_forms','onb_spreadsheets','onb_api','onb_widget',
  'ver_manual','ver_3p_int','ver_3p_nonint',
  'pay_manual_psp','pay_wires','pay_cheques','pay_digital_wallets',
  'appr_none','appr_single','appr_dual',
  'tax_collects','tax_manual_share','tax_eoy'
];

function hasStep2Selections(){
  return STEP2_IDS.some(id => {
    const el = document.getElementById(id);
    return !!(el && el.checked);
  });
}

function state(){
  const rc = Array.from(document.querySelectorAll('.rc:checked')).map(x=>x.value);
  const g  = id => { const el=document.getElementById(id); return !!(el && el.checked); };
  return {
    merchant_name: $('#merchant_name').value.trim(),
    merchant_type: $('#merchant_type').value,
    onboarding_country: $('#onboarding_country').value,
    funding_currency: $('#funding_currency').value,
    recipient_countries: rc,
    onb_forms: g('onb_forms'), onb_spreadsheets: g('onb_spreadsheets'), onb_api: g('onb_api'), onb_widget: g('onb_widget'),
    ver_manual: g('ver_manual'), ver_3p_int: g('ver_3p_int'), ver_3p_nonint: g('ver_3p_nonint'),
    pay_manual_psp: g('pay_manual_psp'), pay_wires: g('pay_wires'), pay_cheques: g('pay_cheques'), pay_digital_wallets: g('pay_digital_wallets'),
    appr_none: g('appr_none'), appr_single: g('appr_single'), appr_dual: g('appr_dual'),
    tax_collects: g('tax_collects'), tax_manual_share: g('tax_manual_share'), tax_eoy: g('tax_eoy'),
  };
}

function computeBundle(s){
  // Gate: no bundle until at least one Step 2 checkbox is selected
  if (!hasStep2Selections()) return null;

  const hasTax = s.tax_collects || s.tax_manual_share || s.tax_eoy;
  const hasTrust = s.ver_manual || s.ver_3p_int || s.ver_3p_nonint;
  const hasPayment = s.pay_manual_psp || s.pay_wires || s.pay_cheques || s.pay_digital_wallets;

  if (hasTax && hasTrust) return "Pay + Tax + Trust";
  if (hasTax) return "Pay + Tax";
  if (hasTrust && hasPayment) return "Pay + Trust";
  return "Pay";
}
function bundleKey(bundle){
  if (bundle.includes("Tax") && bundle.includes("Trust")) return "PAY_TAX_TRUST";
  if (bundle.includes("Trust")) return "PAY_TRUST";
  if (bundle.includes("Tax")) return "PAY_TAX";
  return "PAY";
}

// PayPal-only helper and diagram key chooser
function isPayPalOnlyPayments(s){
  return !!(s.pay_digital_wallets && !s.pay_manual_psp && !s.pay_wires && !s.pay_cheques);
}
function computeDiagramKey(s, bundle){
  const base = bundleKey(bundle);
  if (isPayPalOnlyPayments(s)){
    if (base === 'PAY') return 'PAY_PAYPAL';
    if (base === 'PAY_TAX') return 'PAY_TAX_PAYPAL';
    if (base === 'PAY_TRUST') return 'PAY_TRUST_PAYPAL';
    if (base === 'PAY_TAX_TRUST') return 'PAY_TAX_TRUST_PAYPAL';
  }
  return base;
}
function computeIntegration(s){
  const api = s.onb_api, widget = s.onb_widget;
  if (api && widget) return "Widget now → API later";
  if (api) return "API (Developer-led)";
  if (widget) return "Widget";
  return "Widget";
}
function computeTimeline(s,bundle,integration){
  let c=0;
  if((bundle||"").includes("Tax")) c++;
  if((bundle||"").includes("Trust")) c++;
  if(integration.includes("API")) c++;
  if((s.recipient_countries||[]).length>=3) c++;
  if(c<=1) return "2–3 weeks";
  if(c===2) return "4–6 weeks";
  if(c===3) return "6–8 weeks";
  return "8–12 weeks";
}
function summarize(s,bundle,integration,timeline){
  const name = s.merchant_name || "the merchant";
  const regions = (s.recipient_countries||[]).join(", ") || "selected regions";
  const currency = s.funding_currency || "selected currency";
  const parts = [];
  parts.push(`For ${name}, we recommend ${bundle} with ${integration}.`);
  parts.push(`Funding in ${currency}; paying recipients across ${regions}.`);
  if(bundle.includes("Tax")) parts.push("Enable digital W‑8/W‑9 capture and year‑end filing.");
  if(bundle.includes("Trust")) parts.push("Add verification to reduce risk and automate checks.");
  if(integration.includes("API")) parts.push("Use the /create-a-batch API for payment prep; use Invoices if taxable segmentation is required.");
  if(!integration.includes("API")) parts.push("Leverage widget and in‑platform approvals for a fast rollout.");
  parts.push(`Estimated delivery: ${timeline}.`);
  return parts.join(" ");
}

function mapRow(step,current,future,prods){
  const tr=document.createElement('tr');
  tr.innerHTML = `<td><b>${step}</b></td><td>${current||'—'}</td><td>${future}</td><td>${prods}</td>`;
  return tr;
}
function buildMapping(s,bundle,integration){
  const tbody = $('#mapBody'); tbody.innerHTML = "";
  const onb_current = [ s.onb_forms && "Manual Forms", s.onb_spreadsheets && "Spreadsheet Uploads", s.onb_api && "API", s.onb_widget && "Widget/Application" ].filter(Boolean).join(", ") || "—";
  const ver_current = [ s.ver_manual && "Manual", s.ver_3p_int && "3rd party (integrated)", s.ver_3p_nonint && "3rd party (non‑integrated)" ].filter(Boolean).join(", ") || "—";
  const pay_current = [ s.pay_manual_psp && "Manual payouts (E-Transfer, Wise, etc.)", s.pay_digital_wallets && "Digital Wallets (PayPal)", s.pay_wires && "Manual Wires", s.pay_cheques && "Cheques" ].filter(Boolean).join(", ") || "—";
  const appr_current = [ s.appr_none && "None", s.appr_single && "Single", s.appr_dual && "Dual" ].filter(Boolean).join(", ") || "—";
  const tax_current = [ s.tax_collects && "Collects W‑8/W‑9", s.tax_manual_share && "Manual sharing", s.tax_eoy && "End‑of‑Year Filing" ].filter(Boolean).join(", ") || "—";

  const onb_future = integration.includes("API") ? "Auto‑collection via API + optional widget" : "Auto‑collection via Trolley Widget";
  const ver_future = (bundle||"").includes("Trust") ? "Automated verification & failure triage" : "Basic checks; manual review as needed";
  let pay_future = integration.includes("API") ? "Batch creation via /create‑a‑batch; approvals in‑platform; payouts automated" : "Prepare batches in platform; approvals & payouts automated";
  if (isPayPalOnlyPayments(s)) pay_future += " via PayPal integration";
  const appr_future = "Role‑based approvals in‑platform";
  const tax_future = (bundle||"").includes("Tax") ? "Digital W‑8/W‑9 collection and year‑end filing; use Invoices if taxable segmentation needed" : "N/A";

  tbody.appendChild(mapRow("Recipient Onboarding", onb_current, onb_future, (bundle||"").includes("Trust")?"Pay, Trust":"Pay"));
  tbody.appendChild(mapRow("Verification", ver_current, ver_future, (bundle||"").includes("Trust")?"Trust":"—"));
  tbody.appendChild(mapRow("Payments", pay_current, pay_future, "Pay"));
  tbody.appendChild(mapRow("Payment Approvals", appr_current, appr_future, "Pay"));
  tbody.appendChild(mapRow("Tax & Reporting", tax_current, tax_future, (bundle||"").includes("Tax")?"Tax":"—"));
}
function buildRoadmap(bundle,integration){
  const phases=[];
  phases.push("Phase 1 – Foundation: Fund account, configure integration, assign roles.");
  phases.push("Phase 2 – Recipient Onboarding: " + (integration.includes("API")?"API (with optional widget)":"Trolley Widget") + " and map external IDs.");
  phases.push("Phase 3 – Payments: " + (integration.includes("API")?"Create batches via /create‑a‑batch; approvals in‑platform; automate payouts.":"Prepare batches in platform; approvals & payouts automated."));
  if((bundle||"").includes("Tax")) phases.push("Phase 4 – Tax & Compliance: Digital W‑8/W‑9, validation, year‑end filing.");
  if((bundle||"").includes("Trust")) phases.push("Phase 4b – Trust: Verification flows and failure triage.");
  phases.push("Phase 5 – Go‑Live & Optimize: Dry‑run payouts, migrate recipients, monitor dashboards.");
  const ol = $('#phases'); ol.innerHTML=''; phases.forEach(t=>{ const li=document.createElement('li'); li.textContent=t; ol.appendChild(li); });
}
function setDiagram(imgEl, phEl, bundle){
  const s = state();
  const key = computeDiagramKey(s, bundle);
  const path = IMG[key] || "";
  if(path){
    imgEl.src = path;                   // local file in same folder
    imgEl.style.display = "block";
    if (phEl) phEl.style.display = "none";
  }else{
    imgEl.removeAttribute("src");
    imgEl.style.display = "none";
    if (phEl) phEl.style.display = "block";
  }
}

function render(){
  const s = state();
  const bundle = computeBundle(s);              // null until Step 2 touched
  const integration = computeIntegration(s);
  const timeline = computeTimeline(s, bundle || "", integration);

  // Header pills
  $('#bundle').textContent      = bundle || '—';
  $('#integration').textContent = integration;
  $('#timeline').textContent    = timeline;

  // Proposed Solution diagram only (gated)
  const imgB = $('#diagramB'), phB = $('#diagramPlaceholderB');
  if (bundle) {
    setDiagram(imgB, phB, bundle);
  } else {
    imgB.removeAttribute('src'); imgB.style.display='none';
    if (phB) phB.style.display='block';
  }

  // Summary only when bundle exists
  $('#summary').textContent = bundle ? summarize(s, bundle, integration, timeline) : '';

  // Table & roadmap can still render with defaults
  buildMapping(s, bundle || 'Pay', integration);
  buildRoadmap(bundle || 'Pay', integration);
}

function resetAll(){
  document.querySelectorAll('input[type="text"]').forEach(i=>i.value="");
  document.querySelectorAll('select').forEach(s=>s.selectedIndex=0);
  document.querySelectorAll('input[type="checkbox"]').forEach(c=>c.checked=false);
  render();
}

// PDF: only summary, diagram, mapping, roadmap — in a separate print window
function generatePDF(){
  const s = state();
  const bundle = computeBundle(s);              // may be null
  const integration = computeIntegration(s);
  const timeline = computeTimeline(s, bundle || "", integration);
  const key = bundle ? computeDiagramKey(s, bundle) : null;
  const diagramSrc = key ? IMG[key] : "";

  const date = new Date().toISOString().slice(0,10);

  // Build the print-only HTML
  const wrapper = document.createElement('div');
  wrapper.innerHTML = `
    <h1 style="margin:0 0 8px;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif">Trolley Onboarding Plan</h1>
    <div style="color:#64748b;font-size:12px;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif">${s.merchant_name || "Merchant"} · Generated ${date}</div>
    <hr style="border:0;border-top:1px solid #e2e8f0;margin:12px 0" />
    <h3 style="font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif">Proposed Solution</h3>
    <div><b>Recommended Bundle:</b> ${bundle || '—'}</div>
    <div><b>Integration Mode:</b> ${integration}</div>
    <div><b>Indicative Timeline:</b> ${timeline}</div>
    ${diagramSrc ? `<div style=\"margin:12px 0;\"><img src=\"${diagramSrc}\" style=\"max-width:100%;border:1px solid #e2e8f0;border-radius:8px\" /></div>`
                 : `<div style=\"color:#64748b;font-size:12px\">(No diagram — select options in Step 2)</div>`}
    <div style="margin-top:8px; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif">${bundle ? summarize(s,bundle,integration,timeline) : ''}</div>
    <h3 style="margin-top:16px;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif">Current → Future Mapping</h3>
  `;

  // Clone the mapping table (keeps what is rendered on screen)
  const mapClone = document.querySelector('#mapping table').cloneNode(true);
  wrapper.appendChild(mapClone);

  // Roadmap list
  const ul = document.createElement('ol');
  document.querySelectorAll('#phases li').forEach(li=>{
    const n=document.createElement('li'); n.textContent=li.textContent; ul.appendChild(n);
  });
  const rmSec = document.createElement('div');
  rmSec.innerHTML = '<h3 style="margin-top:16px;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif">Implementation Roadmap</h3>';
  rmSec.appendChild(ul);
  wrapper.appendChild(rmSec);

  // Print in a separate window so ONLY this content appears
  const win = window.open('', '_blank');
  const styles = `
    <style>
      @page { size: A4; margin: 16mm; }
      body { background:#fff; color:#0f172a; }
      table { width:100%; border-collapse:collapse; font: 14px system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; }
      th,td { padding:8px 10px; border-bottom:1px solid #e2e8f0; text-align:left; vertical-align:top; }
      th { background:#f8fafc; }
      h1,h2,h3 { font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; }
    </style>`;
  win.document.open();
  win.document.write(`<!doctype html><html><head><meta charset=\"utf-8\" />${styles}<title>Trolley Onboarding Plan</title></head><body>${wrapper.innerHTML}</body></html>`);
  win.document.close();
  win.focus();
  const maybePrint = () => { try { win.print(); } finally { win.close(); } };
  const img = win.document.querySelector('img');
  if (img) { img.onload = maybePrint; img.onerror = maybePrint; } else { maybePrint(); }
}

/* Bind events */
function wire(){
  const controls = document.querySelectorAll('input, select, textarea');
  controls.forEach(el => {
    ['change','input','keyup','click'].forEach(evt => el.addEventListener(evt, render, {passive:true}));
  });
  document.getElementById('btnPdf').addEventListener('click', generatePDF);
  document.getElementById('btnReset').addEventListener('click', resetAll);

  // Make approvals mutually exclusive
  const apprIds = ['appr_none','appr_single','appr_dual'];
  apprIds.forEach(id=>{
    const el=document.getElementById(id);
    if(el){
      el.addEventListener('change',(e)=>{
        if(e.target.checked){
          apprIds.forEach(o=>{ if(o!==id){ const oe=document.getElementById(o); if(oe) oe.checked=false; }});
          render();
        }
      });
    }
  });

  render();
}

document.addEventListener('DOMContentLoaded', wire);
</script>
</body>
</html>
